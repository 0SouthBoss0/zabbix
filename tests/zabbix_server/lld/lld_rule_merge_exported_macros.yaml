---
test case: Test single match
in:
  entry:
    macros:
    - macro: 'one'
      value: '1'
    exported_macros: []
  db: 
  - lld_macroid: 1
    name: 'one'
    value: '1'
out: 
  macros: []
---
test case: Test empty data
in:
  entry: 
    macros: []
    exported_macros: []
  db: []
out: 
  macros: []
---
test case: Test one macro added to empty list
in:
  entry:
    macros:
    - macro: 'one'
      value: '1'
    exported_macros: []
  db: []
out: 
  macros:
  - lld_macroid: 0
    name: 'one'
    value: '1'
---
test case: Test two macros added to empty list
in:
  entry:
    macros:
    - macro: 'one'
      value: '1'
    - macro: 'two'
      value: '2'
    exported_macros: []
  db: []
out: 
  macros:
  - lld_macroid: 0
    name: 'one'
    value: '1'
  - lld_macroid: 0
    name: 'two'
    value: '2'
---
test case: Test only macro removed
in:
  entry: 
    macros: []
    exported_macros: []
  db:
  - lld_macroid: 1
    name: 'one'
    value: '1'
out: 
  macros:
  - lld_macroid: 1
---
test case: Test all macros removed
in:
  entry: 
    macros: []
    exported_macros: []
  db:
  - lld_macroid: 1
    name: 'one'
    value: '1'
  - lld_macroid: 3
    name: 'three'
    value: '3'
  - lld_macroid: 2
    name: 'two'
    value: '2'
out: 
  macros:
  - lld_macroid: 1
  - lld_macroid: 3
  - lld_macroid: 2
---
test case: Test first half matching macro updated
in:
  entry:
    macros:
    - macro: 'one'
      value: '11'
    - macro: 'three'
      value: '3'
    - macro: 'two'
      value: '2'
    exported_macros: []
  db:
  - lld_macroid: 1
    name: 'one'
    value: '1'
  - lld_macroid: 3
    name: 'three'
    value: '3'
  - lld_macroid: 2
    name: 'two'
    value: '2'  
out: 
  macros:
  - lld_macroid: 1
    name: 'one'
    value: '11'
---
test case: Test first macro updated
in:
  entry:
    macros:
    - macro: 'one-four'
      value: '4'
    - macro: 'three'
      value: '3'
    - macro: 'two'
      value: '2'
    exported_macros: []
  db:
  - lld_macroid: 1
    name: 'one'
    value: '1'
  - lld_macroid: 3
    name: 'three'
    value: '3'
  - lld_macroid: 2
    name: 'two'
    value: '2'  
out: 
  macros:
  - lld_macroid: 1
    name: 'one-four'
    value: '4'
---
test case: Test middle half matching macro updated
in:
  entry:
    macros:
    - macro: 'one'
      value: '1'
    - macro: 'three'
      value: '33'
    - macro: 'two'
      value: '2'
    exported_macros: []
  db:
  - lld_macroid: 1
    name: 'one'
    value: '1'
  - lld_macroid: 3
    name: 'three'
    value: '3'
  - lld_macroid: 2
    name: 'two'
    value: '2'  
out: 
  macros:
  - lld_macroid: 3
    name: 'three'
    value: '33'
---
test case: Test middle macro updated
in:
  entry:
    macros:
    - macro: 'one'
      value: '1'
    - macro: 'three-four'
      value: '4'
    - macro: 'two'
      value: '2'
    exported_macros: []
  db:
  - lld_macroid: 1
    name: 'one'
    value: '1'
  - lld_macroid: 3
    name: 'three'
    value: '3'
  - lld_macroid: 2
    name: 'two'
    value: '2'  
out: 
  macros:
  - lld_macroid: 3
    name: 'three-four'
    value: '4'
---
test case: Test last half matching macro updated
in:
  entry:
    macros:
    - macro: 'one'
      value: '1'
    - macro: 'three'
      value: '3'
    - macro: 'two'
      value: '22'
    exported_macros: []
  db:
  - lld_macroid: 1
    name: 'one'
    value: '1'
  - lld_macroid: 3
    name: 'three'
    value: '3'
  - lld_macroid: 2
    name: 'two'
    value: '2'
out: 
  macros:
  - lld_macroid: 2
    name: 'two'
    value: '22'
---
test case: Test last macro updated
in:
  entry:
    macros:
    - macro: 'one'
      value: '1'
    - macro: 'three'
      value: '3'
    - macro: 'two-four'
      value: '4'
    exported_macros: []
  db:
  - lld_macroid: 1
    name: 'one'
    value: '1'
  - lld_macroid: 3
    name: 'three'
    value: '3'
  - lld_macroid: 2
    name: 'two'
    value: '2'
out: 
  macros:
  - lld_macroid: 2
    name: 'two-four'
    value: '4'
---
test case: Test new exported macros
in:
  entry:
    macros:
    - macro: 'one'
      value: '1'
    - macro: 'two'
      value: '2'
    exported_macros:
    - macro: 'three'
      value: '3'
  db: []
out: 
  macros:
  - lld_macroid: 0
    name: 'one'
    value: '1'
  - lld_macroid: 0
    name: 'three'
    value: '3'
  - lld_macroid: 0
    name: 'two'
    value: '2'
---
test case: Test overlapping exported macros
in:
  entry:
    macros:
    - macro: 'one'
      value: '1'
    - macro: 'two'
      value: '2'
    exported_macros:
    - macro: 'one'
      value: '1111'
  db: []
out: 
  macros:
  - lld_macroid: 0
    name: 'one'
    value: '1'
  - lld_macroid: 0
    name: 'two'
    value: '2'
...
