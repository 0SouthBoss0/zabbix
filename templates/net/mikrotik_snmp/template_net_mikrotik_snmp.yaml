zabbix_export:
  version: '5.4'
  date: '2021-05-09T00:00:00Z'
  groups:
    -
      uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    -
      uuid: 815b5a81b29a477695fddbd533ad9c84
      template: 'Mikrotik SNMP'
      name: 'Mikrotik SNMP'
      description: |
        Template Net Mikrotik
        
        MIBs used:
        HOST-RESOURCES-MIB
        MIKROTIK-MIB
        
        Known Issues:
        
          Description: Doesn't have ifHighSpeed filled. fixed in more recent versions
          Version: RouterOS 6.28 or lower
        
          Description: Doesn't have any temperature sensors
          Version: RouterOS 6.38.5
          Device: Mikrotik 941-2nD, Mikrotik 951G-2HnD
        
        Template tooling version used: 0.38
      templates:
        -
          name: 'Generic SNMP'
        -
          name: 'Interfaces SNMP'
      groups:
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: 260eff3ec4034e33aea9c25962a782be
          name: 'Firmware version'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.14988.1.1.7.4.0
          key: system.hw.firmware
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: MIKROTIK-MIB
            Current firmware version.
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Application
              value: Inventory
          triggers:
            -
              uuid: 649bc89b4b274656bd2cdf2c47631bfd
              expression: '{diff()}=1 and {strlen()}>0'
              name: 'Firmware has changed'
              opdata: 'Current value: {ITEM.LASTVALUE1}'
              priority: INFO
              description: 'Firmware version has changed. Ack to close'
              manual_close: 'YES'
        -
          uuid: 8d2c5a405ffa42fc81a2c9b914e20874
          name: 'Hardware model name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.1.1.0
          key: system.hw.model
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          inventory_link: MODEL
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Application
              value: Inventory
        -
          uuid: 2c5a89f75a8d4e38ad021b3539ce8273
          name: 'Hardware serial number'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.14988.1.1.7.3.0
          key: system.hw.serialnumber
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: MIKROTIK-MIB
            RouterBOARD serial number.
          inventory_link: SERIALNO_A
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Application
              value: Inventory
          triggers:
            -
              uuid: c1c0342e1dc148c19de91c0eba7fd1eb
              expression: '{diff()}=1 and {strlen()}>0'
              name: 'Device has been replaced (new serial number received)'
              priority: INFO
              description: 'Device serial number has changed. Ack to close'
              manual_close: 'YES'
        -
          uuid: 7e3b3e78086742a7b9cda953367a2d83
          name: 'Operating system'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.14988.1.1.4.4.0
          key: 'system.sw.os[mtxrLicVersion.0]'
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: MIKROTIK-MIB
            Software version.
          inventory_link: OS
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Application
              value: Inventory
          triggers:
            -
              uuid: 1f56ba1d84cb464984c064293de4b60c
              expression: '{diff()}=1 and {strlen()}>0'
              name: 'Operating system description has changed'
              priority: INFO
              description: 'Operating system description has changed. Possible reasons that system has been updated or replaced. Ack to close.'
              manual_close: 'YES'
        -
          uuid: 0636e173288d42e68faf62c381a65087
          name: 'Total memory'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.25.2.3.1.5.65536
          key: 'vm.memory.total[hrStorageSize.Memory]'
          history: 7d
          units: B
          description: |
            MIB: HOST-RESOURCES-MIB
            The size of the storage represented by this entry, in
            units of hrStorageAllocationUnits. This object is
            writable to allow remote configuration of the size of
            the storage area in those cases where such an
            operation makes sense and is possible on the
            underlying system. For example, the amount of main
            memory allocated to a buffer pool might be modified or
            the amount of disk space allocated to virtual memory
            might be modified.
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            -
              tag: Application
              value: Memory
        -
          uuid: 7d4a1591887848028ea8bae81b7d01a7
          name: 'Used memory'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.2.1.25.2.3.1.6.65536
          key: 'vm.memory.used[hrStorageUsed.Memory]'
          history: 7d
          units: B
          description: |
            MIB: HOST-RESOURCES-MIB
            The amount of the storage represented by this entry that is allocated, in units of hrStorageAllocationUnits.
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1024'
          tags:
            -
              tag: Application
              value: Memory
        -
          uuid: 56017f610bf74f0aaaa92e9183e68ea5
          name: 'Memory utilization'
          type: CALCULATED
          key: 'vm.memory.util[memoryUsedPercentage.Memory]'
          history: 7d
          value_type: FLOAT
          units: '%'
          params: 'last("vm.memory.used[hrStorageUsed.Memory]")/last("vm.memory.total[hrStorageSize.Memory]")*100'
          description: 'Memory utilization in %'
          tags:
            -
              tag: Application
              value: Memory
          triggers:
            -
              uuid: 0c8528708fda4f809dc0f6267e869568
              expression: '{min(5m)}>{$MEMORY.UTIL.MAX}'
              name: 'High memory utilization (>{$MEMORY.UTIL.MAX}% for 5m)'
              priority: AVERAGE
              description: 'The system is running out of free memory.'
      discovery_rules:
        -
          uuid: fb2a399dbdb54484a9f58ae2437c32fb
          name: 'CPU discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.2.1.25.3.3.1.1]'
          key: hrProcessorLoad.discovery
          delay: 1h
          description: 'HOST-RESOURCES-MIB::hrProcessorTable discovery'
          item_prototypes:
            -
              uuid: 560173245c8245128bc7071b8201fe12
              name: '#{#SNMPINDEX}: CPU utilization'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.25.3.3.1.2.{#SNMPINDEX}'
              key: 'system.cpu.util[hrProcessorLoad.{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              description: |
                MIB: HOST-RESOURCES-MIB
                The average, over the last minute, of the percentage of time that this processor was not idle. Implementations may approximate this one minute smoothing period if necessary.
              tags:
                -
                  tag: Application
                  value: CPU
              trigger_prototypes:
                -
                  uuid: 97cfbf9ef789433092aea27dfa9be8e3
                  expression: '{min(5m)}>{$CPU.UTIL.CRIT}'
                  name: '#{#SNMPINDEX}: High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)'
                  opdata: 'Current utilization: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'CPU utilization is too high. The system might be slow to respond.'
          graph_prototypes:
            -
              uuid: 1e6e64b461dc4010a582d2f39fcfa4f8
              name: '#{#SNMPINDEX}: CPU utilization'
              ymin_type_1: FIXED
              ymax_type_1: FIXED
              graph_items:
                -
                  drawtype: GRADIENT_LINE
                  color: 1A7C11
                  item:
                    host: 'Mikrotik SNMP'
                    key: 'system.cpu.util[hrProcessorLoad.{#SNMPINDEX}]'
        -
          uuid: 9a4ae5c2a50d4414ab0eed2c70bcd9c3
          name: 'Temperature CPU discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.14988.1.1.3.11]'
          key: mtxrHlProcessorTemperature.discovery
          delay: 1h
          description: |
            MIKROTIK-MIB::mtxrHlProcessorTemperature
            Since temperature of CPU is not available on all Mikrotik hardware, this is done to avoid unsupported items.
          item_prototypes:
            -
              uuid: ad101c676b5243eca67eb68d879f5212
              name: 'CPU: Temperature'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14988.1.1.3.11.{#SNMPINDEX}'
              key: 'sensor.temp.value[mtxrHlProcessorTemperature.{#SNMPINDEX}]'
              delay: 3m
              value_type: FLOAT
              units: °C
              description: |
                MIB: MIKROTIK-MIB
                mtxrHlProcessorTemperature Processor temperature in Celsius (degrees C).
                Might be missing in entry models (RB750, RB450G..).
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.1'
              tags:
                -
                  tag: Application
                  value: Temperature
              trigger_prototypes:
                -
                  uuid: cb81bdf4906641879d250f99c625170a
                  expression: '{avg(5m)}>{$TEMP_CRIT:"CPU"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: '{max(5m)}<{$TEMP_CRIT:"CPU"}-3'
                  name: 'CPU: Temperature is above critical threshold: >{$TEMP_CRIT:"CPU"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                -
                  uuid: 28d076afdd044a5aafbd061f0fe29068
                  expression: '{avg(5m)}>{$TEMP_WARN:"CPU"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: '{max(5m)}<{$TEMP_WARN:"CPU"}-3'
                  name: 'CPU: Temperature is above warning threshold: >{$TEMP_WARN:"CPU"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                  dependencies:
                    -
                      name: 'CPU: Temperature is above critical threshold: >{$TEMP_CRIT:"CPU"}'
                      expression: '{Mikrotik SNMP:sensor.temp.value[mtxrHlProcessorTemperature.{#SNMPINDEX}].avg(5m)}>{$TEMP_CRIT:"CPU"}'
                      recovery_expression: '{Mikrotik SNMP:sensor.temp.value[mtxrHlProcessorTemperature.{#SNMPINDEX}].max(5m)}<{$TEMP_CRIT:"CPU"}-3'
                -
                  uuid: b969ea9b26b84ac38a1469fa0e9f417b
                  expression: '{avg(5m)}<{$TEMP_CRIT_LOW:"CPU"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: '{min(5m)}>{$TEMP_CRIT_LOW:"CPU"}+3'
                  name: 'CPU: Temperature is too low: <{$TEMP_CRIT_LOW:"CPU"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
        -
          uuid: 9c6a401a70ec4dba92bd9e270fe7dc79
          name: 'Temperature sensor discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.14988.1.1.3.10]'
          key: mtxrHlTemperature.discovery
          delay: 1h
          description: |
            MIKROTIK-MIB::mtxrHlTemperature
            Since temperature sensor is not available on all Mikrotik hardware,
            this is done to avoid unsupported items.
          item_prototypes:
            -
              uuid: 2bfb758ca6264401902524b32e04f472
              name: 'Device: Temperature'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14988.1.1.3.10.{#SNMPINDEX}'
              key: 'sensor.temp.value[mtxrHlTemperature.{#SNMPINDEX}]'
              delay: 3m
              value_type: FLOAT
              units: °C
              description: |
                MIB: MIKROTIK-MIB
                mtxrHlTemperature Device temperature in Celsius (degrees C).
                Might be missing in entry models (RB750, RB450G..).
                
                Reference: http://wiki.mikrotik.com/wiki/Manual:SNMP
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '0.1'
              tags:
                -
                  tag: Application
                  value: Temperature
              trigger_prototypes:
                -
                  uuid: 3e5ffd79ef82453f8667ae1c320a044d
                  expression: '{avg(5m)}>{$TEMP_CRIT:"Device"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: '{max(5m)}<{$TEMP_CRIT:"Device"}-3'
                  name: 'Device: Temperature is above critical threshold: >{$TEMP_CRIT:"Device"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: HIGH
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                -
                  uuid: cb5a098cf69d4d898ed65ed268fc9601
                  expression: '{avg(5m)}>{$TEMP_WARN:"Device"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: '{max(5m)}<{$TEMP_WARN:"Device"}-3'
                  name: 'Device: Temperature is above warning threshold: >{$TEMP_WARN:"Device"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: WARNING
                  description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
                  dependencies:
                    -
                      name: 'Device: Temperature is above critical threshold: >{$TEMP_CRIT:"Device"}'
                      expression: '{Mikrotik SNMP:sensor.temp.value[mtxrHlTemperature.{#SNMPINDEX}].avg(5m)}>{$TEMP_CRIT:"Device"}'
                      recovery_expression: '{Mikrotik SNMP:sensor.temp.value[mtxrHlTemperature.{#SNMPINDEX}].max(5m)}<{$TEMP_CRIT:"Device"}-3'
                -
                  uuid: 2c7e69d90e824fc9868e8cd696575004
                  expression: '{avg(5m)}<{$TEMP_CRIT_LOW:"Device"}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: '{min(5m)}>{$TEMP_CRIT_LOW:"Device"}+3'
                  name: 'Device: Temperature is too low: <{$TEMP_CRIT_LOW:"Device"}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
        -
          uuid: 017797e68eae49afaa864dd57757bbd8
          name: 'LTE modem discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFNAME},1.3.6.1.4.1.14988.1.1.14.1.1.2,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]'
          key: mtxrLTEModem.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#IFTYPE}'
                value: ^1$
                formulaid: B
              -
                macro: '{#IFNAME}'
                value: '{$IFNAME.LTEMODEM.MATCHES}'
                formulaid: A
          description: 'MIKROTIK-MIB::mtxrLTEModemInterfaceIndex'
          item_prototypes:
            -
              uuid: 25cf4b11ade848fb9947ef85c59da65a
              name: 'Interface {#IFNAME}({#IFALIAS}): LTE modem RSRP'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14988.1.1.16.1.1.4.{#SNMPINDEX}'
              key: 'lte.modem.rsrp[mtxrLTEModemSignalRSRP.{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: dbm
              description: |
                MIB: MIKROTIK-MIB
                mtxrLTEModemSignalRSRP Reference Signal Received Power.
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
              trigger_prototypes:
                -
                  uuid: 31b71246d36b4be98160cb44246d406f
                  expression: '{max(5m)} < {$LTEMODEM.RSRP.MIN.WARN}'
                  name: 'Interface {#IFNAME}({#IFALIAS}): LTE modem RSRP is low (below {$LTEMODEM.RSRP.MIN.WARN}dbm for 5m)'
                  priority: WARNING
            -
              uuid: 467f6179fa7d43c2a23333330c1ceac1
              name: 'Interface {#IFNAME}({#IFALIAS}): LTE modem RSRQ'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14988.1.1.16.1.1.3.{#SNMPINDEX}'
              key: 'lte.modem.rsrq[mtxrLTEModemSignalRSRQ.{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: db
              description: |
                MIB: MIKROTIK-MIB
                mtxrLTEModemSignalRSRQ Reference Signal Received Quality.
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
              trigger_prototypes:
                -
                  uuid: af8bb25f31a744fab6221ec5bd82a2be
                  expression: '{max(5m)} < {$LTEMODEM.RSRQ.MIN.WARN}'
                  name: 'Interface {#IFNAME}({#IFALIAS}): LTE modem RSRQ is low (below {$LTEMODEM.RSRQ.MIN.WARN}db for 5m)'
                  priority: WARNING
            -
              uuid: 0994d40dab10493c96c4f79d0cc5e619
              name: 'Interface {#IFNAME}({#IFALIAS}): LTE modem RSSI'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14988.1.1.16.1.1.2.{#SNMPINDEX}'
              key: 'lte.modem.rssi[mtxrLTEModemSignalRSSI.{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: dbm
              description: |
                MIB: MIKROTIK-MIB
                mtxrLTEModemSignalRSSI Received Signal Strength Indicator.
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
              trigger_prototypes:
                -
                  uuid: f159cb1808354c58ac385698d3fc9ff6
                  expression: '{max(5m)} < {$LTEMODEM.RSSI.MIN.WARN}'
                  name: 'Interface {#IFNAME}({#IFALIAS}): LTE modem RSSI is low (below {$LTEMODEM.RSSI.MIN.WARN}dbm for 5m)'
                  priority: WARNING
            -
              uuid: 1c5a284353964175b4541c78fea7d07d
              name: 'Interface {#IFNAME}({#IFALIAS}): LTE modem SINR'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14988.1.1.16.1.1.7.{#SNMPINDEX}'
              key: 'lte.modem.sinr[mtxrLTEModemSignalSINR.{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: db
              description: |
                MIB: MIKROTIK-MIB
                mtxrLTEModemSignalSINR Signal to Interference & Noise Ratio.
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
              trigger_prototypes:
                -
                  uuid: d75814c6577d4cc4b951985d6abd6eff
                  expression: '{max(5m)} < {$LTEMODEM.SINR.MIN.WARN}'
                  name: 'Interface {#IFNAME}({#IFALIAS}): LTE modem SINR is low (below {$LTEMODEM.SINR.MIN.WARN}db for 5m)'
                  priority: WARNING
          graph_prototypes:
            -
              uuid: 4f6bc67c40eb441189ec233f926f19ec
              name: 'Interface {#IFNAME}({#IFALIAS}): Modem Signal. {#SNMPINDEX}'
              graph_items:
                -
                  color: 1A7C11
                  item:
                    host: 'Mikrotik SNMP'
                    key: 'lte.modem.sinr[mtxrLTEModemSignalSINR.{#SNMPINDEX}]'
                -
                  sortorder: '1'
                  color: 2774A4
                  item:
                    host: 'Mikrotik SNMP'
                    key: 'lte.modem.rsrq[mtxrLTEModemSignalRSRQ.{#SNMPINDEX}]'
                -
                  sortorder: '2'
                  color: F63100
                  item:
                    host: 'Mikrotik SNMP'
                    key: 'lte.modem.rsrp[mtxrLTEModemSignalRSRP.{#SNMPINDEX}]'
                -
                  sortorder: '3'
                  color: A54F10
                  item:
                    host: 'Mikrotik SNMP'
                    key: 'lte.modem.rssi[mtxrLTEModemSignalRSSI.{#SNMPINDEX}]'
        -
          uuid: 5eada6e6837648859ccb440525281698
          name: 'AP channel discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFNAME},1.3.6.1.4.1.14988.1.1.14.1.1.2,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFTYPE},1.3.6.1.2.1.2.2.1.3,{#IFADMINSTATUS},1.3.6.1.2.1.2.2.1.7]'
          key: mtxrWlAp.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#IFTYPE}'
                value: ^71$
                formulaid: B
              -
                macro: '{#IFADMINSTATUS}'
                value: ^1$
                formulaid: A
          description: 'MIKROTIK-MIB::mtxrWlAp'
          item_prototypes:
            -
              uuid: db129187106741d88fc14774a1a5652d
              name: 'Interface {#IFNAME}({#IFALIAS}): AP authenticated clients'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14988.1.1.1.3.1.11.{#SNMPINDEX}'
              key: 'ssid.authclient[mtxrWlApAuthClientCount.{#SNMPINDEX}]'
              history: 7d
              description: |
                MIB: MIKROTIK-MIB
                mtxrWlApAuthClientCount Number of authentication clients.
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              uuid: a9ca50960dd043038808f3572d1fb281
              name: 'Interface {#IFNAME}({#IFALIAS}): AP band'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14988.1.1.1.3.1.8.{#SNMPINDEX}'
              key: 'ssid.band[mtxrWlApBand.{#SNMPINDEX}]'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                MIB: MIKROTIK-MIB
                mtxrWlApBand
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              uuid: 9f5c294b30d24e5084e8953173bf886e
              name: 'Interface {#IFNAME}({#IFALIAS}): SSID'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14988.1.1.1.3.1.4.{#SNMPINDEX}'
              key: 'ssid.name[mtxrWlApSsid.{#SNMPINDEX}]'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                MIB: MIKROTIK-MIB
                mtxrWlApSsid Service Set Identifier.
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              uuid: 6140d7fe8011400cb827339f8f6f9cdf
              name: 'Interface {#IFNAME}({#IFALIAS}): AP noise floor'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14988.1.1.1.3.1.9.{#SNMPINDEX}'
              key: 'ssid.noise[mtxrWlApNoiseFloor.{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              description: |
                MIB: MIKROTIK-MIB
                mtxrWlApNoiseFloor
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 15m
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              uuid: 45fc6875a91d47debb4e39d93e5b8186
              name: 'Interface {#IFNAME}({#IFALIAS}): AP registered clients'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14988.1.1.1.3.1.6.{#SNMPINDEX}'
              key: 'ssid.regclient[mtxrWlApClientCount.{#SNMPINDEX}]'
              history: 7d
              description: |
                MIB: MIKROTIK-MIB
                mtxrWlApClientCount Client established connection to AP, but didn't finish all authetncation procedures for full connection.
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
        -
          uuid: 644433b2a1fa4b38916e2ae4bf74c28d
          name: 'CAPsMAN AP channel discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFNAME},1.3.6.1.4.1.14988.1.1.14.1.1.2,{#IFALIAS},1.3.6.1.2.1.31.1.1.1.18,{#IFTYPE},1.3.6.1.2.1.2.2.1.3]'
          key: mtxrWlCMChannel.discovery
          delay: 1h
          filter:
            evaltype: AND
            conditions:
              -
                macro: '{#IFTYPE}'
                value: ^1$
                formulaid: B
              -
                macro: '{#IFNAME}'
                value: '{$IFNAME.WIFI.MATCHES}'
                formulaid: A
          description: 'MIKROTIK-MIB::mtxrWlCMChannel'
          item_prototypes:
            -
              uuid: 5dc0caa311304e6a96c620b10f52f267
              name: 'Interface {#IFNAME}({#IFALIAS}): AP authenticated clients'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14988.1.1.1.7.1.3.{#SNMPINDEX}'
              key: 'ssid.authclient[mtxrWlCMAuthClientCount.{#SNMPINDEX}]'
              history: 7d
              description: |
                MIB: MIKROTIK-MIB
                mtxrWlCMAuthClientCount Number of authentication clients.
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              uuid: 7df773f57c234d219f5a75e11844f5e0
              name: 'Interface {#IFNAME}({#IFALIAS}): AP channel'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14988.1.1.1.7.1.5.{#SNMPINDEX}'
              key: 'ssid.channel[mtxrWlCMChannel.{#SNMPINDEX}]'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                MIB: MIKROTIK-MIB
                mtxrWlCMChannel
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              uuid: 0db356f16542489586aacdecb029f691
              name: 'Interface {#IFNAME}({#IFALIAS}): AP registered clients'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14988.1.1.1.7.1.2.{#SNMPINDEX}'
              key: 'ssid.regclient[mtxrWlCMRegClientCount.{#SNMPINDEX}]'
              history: 7d
              description: |
                MIB: MIKROTIK-MIB
                mtxrWlCMRegClientCount Client established connection to AP, but didn't finish all authetncation procedures for full connection.
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
            -
              uuid: e2212bb46d804d6687a2fe992f867b9d
              name: 'Interface {#IFNAME}({#IFALIAS}): AP state'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.14988.1.1.1.7.1.4.{#SNMPINDEX}'
              key: 'ssid.state[mtxrWlCMState.{#SNMPINDEX}]'
              history: 7d
              trends: '0'
              value_type: CHAR
              description: |
                MIB: MIKROTIK-MIB
                mtxrWlCMState Wireless interface state.
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                -
                  tag: Application
                  value: 'Interface {#IFNAME}({#IFALIAS})'
              trigger_prototypes:
                -
                  uuid: b8db1449d7224c2bbc0bcd7295aa8585
                  expression: '{last()}<>"running-ap"'
                  name: 'Interface {#IFNAME}({#IFALIAS}): AP interface {#IFNAME}({#IFALIAS}) is not running'
                  priority: WARNING
                  description: 'Access point interface can be not running by different reasons - disabled interface, power off, network link down.'
        -
          uuid: 6bb65981928d40378a95ee74aff82cc5
          name: 'Storage discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.2.1.25.2.3.1.3,{#ALLOC_UNITS},1.3.6.1.2.1.25.2.3.1.4,{#STORAGE_TYPE},1.3.6.1.2.1.25.2.3.1.2]'
          key: storage.discovery
          delay: 1h
          filter:
            evaltype: OR
            conditions:
              -
                macro: '{#STORAGE_TYPE}'
                value: .+4$
                formulaid: A
              -
                macro: '{#STORAGE_TYPE}'
                value: .+hrStorageFixedDisk
                formulaid: B
          description: 'HOST-RESOURCES-MIB::hrStorage discovery with storage filter'
          item_prototypes:
            -
              uuid: b602ff4381e04e50a9282fe6f9f5c834
              name: 'Disk-{#SNMPINDEX}: Space utilization'
              type: CALCULATED
              key: 'vfs.fs.pused[hrStorageSize.{#SNMPINDEX}]'
              history: 7d
              value_type: FLOAT
              units: '%'
              params: '(last("vfs.fs.used[hrStorageSize.{#SNMPINDEX}]")/last("vfs.fs.total[hrStorageSize.{#SNMPINDEX}]"))*100'
              description: 'Space utilization in % for Disk-{#SNMPINDEX}'
              tags:
                -
                  tag: Application
                  value: Storage
            -
              uuid: 64747345083e4b38b0e963ccd0b8271b
              name: 'Disk-{#SNMPINDEX}: Total space'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.25.2.3.1.5.{#SNMPINDEX}'
              key: 'vfs.fs.total[hrStorageSize.{#SNMPINDEX}]'
              history: 7d
              units: B
              description: |
                MIB: HOST-RESOURCES-MIB
                The size of the storage represented by this entry, in
                units of hrStorageAllocationUnits. This object is
                writable to allow remote configuration of the size of
                the storage area in those cases where such an
                operation makes sense and is possible on the
                underlying system. For example, the amount of main
                memory allocated to a buffer pool might be modified or
                the amount of disk space allocated to virtual memory
                might be modified.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1024'
              tags:
                -
                  tag: Application
                  value: Storage
            -
              uuid: 35034472b281453bbfbcf65b5d60dd7e
              name: 'Disk-{#SNMPINDEX}: Used space'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.25.2.3.1.6.{#SNMPINDEX}'
              key: 'vfs.fs.used[hrStorageSize.{#SNMPINDEX}]'
              history: 7d
              units: B
              description: |
                MIB: HOST-RESOURCES-MIB
                The amount of the storage represented by this entry that is allocated, in units of hrStorageAllocationUnits.
              preprocessing:
                -
                  type: MULTIPLIER
                  parameters:
                    - '1024'
              tags:
                -
                  tag: Application
                  value: Storage
          trigger_prototypes:
            -
              uuid: f270421c0512459588476c418b3b3a9b
              expression: |
                {Mikrotik SNMP:vfs.fs.pused[hrStorageSize.{#SNMPINDEX}].last()}>{$VFS.FS.PUSED.MAX.CRIT:"Disk-{#SNMPINDEX}"} and
                (({Mikrotik SNMP:vfs.fs.total[hrStorageSize.{#SNMPINDEX}].last()}-{Mikrotik SNMP:vfs.fs.used[hrStorageSize.{#SNMPINDEX}].last()})<5G or {Mikrotik SNMP:vfs.fs.pused[hrStorageSize.{#SNMPINDEX}].timeleft(1h,,100)}<1d)
              name: 'Disk-{#SNMPINDEX}: Disk space is critically low (used > {$VFS.FS.PUSED.MAX.CRIT:"Disk-{#SNMPINDEX}"}%)'
              opdata: 'Space used: {ITEM.LASTVALUE3} of {ITEM.LASTVALUE2} ({ITEM.LASTVALUE1})'
              priority: AVERAGE
              description: |
                Two conditions should match: First, space utilization should be above {$VFS.FS.PUSED.MAX.CRIT:"Disk-{#SNMPINDEX}"}.
                 Second condition should be one of the following:
                 - The disk free space is less than 5G.
                 - The disk will be full in less than 24 hours.
              manual_close: 'YES'
            -
              uuid: e6314292cd5c46afae673cdc676b18b6
              expression: |
                {Mikrotik SNMP:vfs.fs.pused[hrStorageSize.{#SNMPINDEX}].last()}>{$VFS.FS.PUSED.MAX.WARN:"Disk-{#SNMPINDEX}"} and
                (({Mikrotik SNMP:vfs.fs.total[hrStorageSize.{#SNMPINDEX}].last()}-{Mikrotik SNMP:vfs.fs.used[hrStorageSize.{#SNMPINDEX}].last()})<10G or {Mikrotik SNMP:vfs.fs.pused[hrStorageSize.{#SNMPINDEX}].timeleft(1h,,100)}<1d)
              name: 'Disk-{#SNMPINDEX}: Disk space is low (used > {$VFS.FS.PUSED.MAX.WARN:"Disk-{#SNMPINDEX}"}%)'
              opdata: 'Space used: {ITEM.LASTVALUE3} of {ITEM.LASTVALUE2} ({ITEM.LASTVALUE1})'
              priority: WARNING
              description: |
                Two conditions should match: First, space utilization should be above {$VFS.FS.PUSED.MAX.WARN:"Disk-{#SNMPINDEX}"}.
                 Second condition should be one of the following:
                 - The disk free space is less than 10G.
                 - The disk will be full in less than 24 hours.
              manual_close: 'YES'
              dependencies:
                -
                  name: 'Disk-{#SNMPINDEX}: Disk space is critically low (used > {$VFS.FS.PUSED.MAX.CRIT:"Disk-{#SNMPINDEX}"}%)'
                  expression: |
                    {Mikrotik SNMP:vfs.fs.pused[hrStorageSize.{#SNMPINDEX}].last()}>{$VFS.FS.PUSED.MAX.CRIT:"Disk-{#SNMPINDEX}"} and
                    (({Mikrotik SNMP:vfs.fs.total[hrStorageSize.{#SNMPINDEX}].last()}-{Mikrotik SNMP:vfs.fs.used[hrStorageSize.{#SNMPINDEX}].last()})<5G or {Mikrotik SNMP:vfs.fs.pused[hrStorageSize.{#SNMPINDEX}].timeleft(1h,,100)}<1d)
          graph_prototypes:
            -
              uuid: 82acee070ff1461ba0cdff337184da97
              name: 'Disk-{#SNMPINDEX}: Disk space usage'
              width: '600'
              height: '340'
              type: PIE
              show_3d: 'YES'
              graph_items:
                -
                  color: '969696'
                  calc_fnc: LAST
                  type: GRAPH_SUM
                  item:
                    host: 'Mikrotik SNMP'
                    key: 'vfs.fs.total[hrStorageSize.{#SNMPINDEX}]'
                -
                  sortorder: '1'
                  color: C80000
                  calc_fnc: LAST
                  item:
                    host: 'Mikrotik SNMP'
                    key: 'vfs.fs.used[hrStorageSize.{#SNMPINDEX}]'
      macros:
        -
          macro: '{$CPU.UTIL.CRIT}'
          value: '90'
        -
          macro: '{$IFNAME.LTEMODEM.MATCHES}'
          value: ^lte
          description: 'This macro is used in LTE modem discovery. It can be overridden on the host.'
        -
          macro: '{$IFNAME.WIFI.MATCHES}'
          value: WIFI
          description: 'This macro is used in CAPsMAN AP channel discovery. It can be overridden on the host level.'
        -
          macro: '{$LTEMODEM.RSRP.MIN.WARN}'
          value: '-100'
          description: 'The LTE modem RSRP minimum value for warning trigger expression.'
        -
          macro: '{$LTEMODEM.RSRQ.MIN.WARN}'
          value: '-20'
          description: 'The LTE modem RSRQ minimum value for warning trigger expression.'
        -
          macro: '{$LTEMODEM.RSSI.MIN.WARN}'
          value: '-100'
          description: 'The LTE modem RSSI minimum value for warning trigger expression.'
        -
          macro: '{$LTEMODEM.SINR.MIN.WARN}'
          value: '0'
          description: 'The LTE modem SINR minimum value for warning trigger expression.'
        -
          macro: '{$MEMORY.UTIL.MAX}'
          value: '90'
        -
          macro: '{$TEMP_CRIT}'
          value: '60'
        -
          macro: '{$TEMP_CRIT:"CPU"}'
          value: '75'
        -
          macro: '{$TEMP_CRIT_LOW}'
          value: '5'
        -
          macro: '{$TEMP_WARN}'
          value: '50'
        -
          macro: '{$TEMP_WARN:"CPU"}'
          value: '70'
        -
          macro: '{$VFS.FS.PUSED.MAX.CRIT}'
          value: '90'
        -
          macro: '{$VFS.FS.PUSED.MAX.WARN}'
          value: '80'
  graphs:
    -
      uuid: 42efab7c7fae46729b2ad410b0be57cc
      name: 'Memory utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        -
          drawtype: GRADIENT_LINE
          color: 1A7C11
          item:
            host: 'Mikrotik SNMP'
            key: 'vm.memory.util[memoryUsedPercentage.Memory]'
