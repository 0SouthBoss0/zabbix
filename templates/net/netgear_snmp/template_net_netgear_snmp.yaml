zabbix_export:
  version: '5.4'
  date: '2021-05-09T00:00:00Z'
  groups:
    -
      uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    -
      uuid: 5920713da492452889adabc25e259caa
      template: 'Netgear Fastpath SNMP'
      name: 'Netgear Fastpath SNMP'
      description: |
        Template Net Netgear Fastpath
        
        MIBs used:
        FASTPATH-SWITCHING-MIB
        FASTPATH-BOXSERVICES-PRIVATE-MIB
        
        Template tooling version used: 0.38
      templates:
        -
          name: 'Generic SNMP'
        -
          name: 'Interfaces SNMP'
      groups:
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: e8ffc912f0ee47cca513861fcecfddb0
          name: 'CPU utilization'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.4526.10.1.1.4.9.0
          key: 'system.cpu.util[agentSwitchCpuProcessTotalUtilization.0]'
          history: 7d
          value_type: FLOAT
          units: '%'
          description: |
            MIB: FASTPATH-SWITCHING-MIB
            CPU utilization in %
          preprocessing:
            -
              type: REGEX
              parameters:
                - '60 Secs \( ([0-9\.]+)%\).+300 Secs'
                - \1
          tags:
            -
              tag: Application
              value: CPU
          triggers:
            -
              uuid: fb162f931322468eb29617772752960b
              expression: '{min(5m)}>{$CPU.UTIL.CRIT}'
              name: 'High CPU utilization (over {$CPU.UTIL.CRIT}% for 5m)'
              opdata: 'Current utilization: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'CPU utilization is too high. The system might be slow to respond.'
        -
          uuid: 2470e113b1174c70a1265bf4c4252b5f
          name: 'Hardware model name'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.4526.10.1.1.1.3.0
          key: system.hw.model
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: 'MIB: FASTPATH-SWITCHING-MIB'
          inventory_link: MODEL
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Application
              value: Inventory
        -
          uuid: 697f863cf86544d4a366e8827976ed50
          name: 'Hardware serial number'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.4526.10.1.1.1.4.0
          key: system.hw.serialnumber
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: FASTPATH-SWITCHING-MIB
            Serial number of the switch
          inventory_link: SERIALNO_A
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Application
              value: Inventory
          triggers:
            -
              uuid: 5e37d334d4674ecc965c4ca7e65b5e5d
              expression: '{diff()}=1 and {strlen()}>0'
              name: 'Device has been replaced (new serial number received)'
              priority: INFO
              description: 'Device serial number has changed. Ack to close'
              manual_close: 'YES'
        -
          uuid: 5bd8c956163d4201a7e896abde28044b
          name: 'Operating system'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.4526.10.1.1.1.10.0
          key: 'system.sw.os[agentInventoryOperatingSystem.0]'
          delay: 1h
          history: 2w
          trends: '0'
          value_type: CHAR
          description: |
            MIB: FASTPATH-SWITCHING-MIB
            Operating System running on this unit
          inventory_link: OS
          preprocessing:
            -
              type: DISCARD_UNCHANGED_HEARTBEAT
              parameters:
                - 1d
          tags:
            -
              tag: Application
              value: Inventory
          triggers:
            -
              uuid: 1d11066f545849baad8056fa03136259
              expression: '{diff()}=1 and {strlen()}>0'
              name: 'Operating system description has changed'
              priority: INFO
              description: 'Operating system description has changed. Possible reasons that system has been updated or replaced. Ack to close.'
              manual_close: 'YES'
        -
          uuid: f94ffd4d6eb84ae88cdf5033df65f249
          name: 'Available memory'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.4526.10.1.1.5.1.0
          key: 'vm.memory.available[agentSwitchCpuProcessMemFree.0]'
          history: 7d
          units: B
          description: |
            MIB: FASTPATH-SWITCHING-MIB
            The total memory freed for utilization.
          tags:
            -
              tag: Application
              value: Memory
        -
          uuid: 98037eeab349478c8c393b163ec5193e
          name: 'Total memory'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.4526.10.1.1.5.2.0
          key: 'vm.memory.total[agentSwitchCpuProcessMemAvailable.0]'
          history: 7d
          units: B
          description: |
            MIB: FASTPATH-SWITCHING-MIB
            The total Memory allocated for the tasks
          tags:
            -
              tag: Application
              value: Memory
        -
          uuid: 86ef153d78b5466cac76a32f81d8b958
          name: 'Memory utilization'
          type: CALCULATED
          key: 'vm.memory.util[memoryUsedPercentage.0]'
          history: 7d
          value_type: FLOAT
          units: '%'
          params: '(last("vm.memory.total[agentSwitchCpuProcessMemAvailable.0]")-last("vm.memory.available[agentSwitchCpuProcessMemFree.0]"))/last("vm.memory.total[agentSwitchCpuProcessMemAvailable.0]")*100'
          description: 'Memory utilization in %'
          tags:
            -
              tag: Application
              value: Memory
          triggers:
            -
              uuid: 9765ec9a7ab349738a0ec4e6d8588776
              expression: '{min(5m)}>{$MEMORY.UTIL.MAX}'
              name: 'High memory utilization (>{$MEMORY.UTIL.MAX}% for 5m)'
              priority: AVERAGE
              description: 'The system is running out of free memory.'
      discovery_rules:
        -
          uuid: 8fb96a540bab4deba00626237797cb62
          name: 'FAN Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.4526.10.43.1.6.1.1]'
          key: fan.discovery
          delay: 1h
          description: 'FASTPATH-BOXSERVICES-PRIVATE-MIB::1.3.6.1.4.1.4526.10.43.1.6.1.1'
          item_prototypes:
            -
              uuid: 9f515526de2c47108182b444d1d093c3
              name: '#{#SNMPVALUE}: Fan status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.4526.10.43.1.6.1.3.{#SNMPINDEX}'
              key: 'sensor.fan.status[boxServicesFanItemState.{#SNMPINDEX}]'
              delay: 3m
              history: 2w
              trends: 0d
              description: |
                MIB: FASTPATH-BOXSERVICES-PRIVATE-MIB
                The status of fan
              valuemap:
                name: 'FASTPATH-BOXSERVICES-PRIVATE-MIB::boxServicesFanItemState'
              tags:
                -
                  tag: Application
                  value: Fans
              trigger_prototypes:
                -
                  uuid: 3022f810657148b087e0f06095203ee3
                  expression: '{count(#1,{$FAN_CRIT_STATUS:"failed"},eq)}=1'
                  name: '#{#SNMPVALUE}: Fan is in critical state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Please check the fan unit'
        -
          uuid: 251d90e9c6ae4dad92328b677f6d6edf
          name: 'PSU Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.4526.10.43.1.7.1.1]'
          key: psu.discovery
          delay: 1h
          description: 'FASTPATH-BOXSERVICES-PRIVATE-MIB::boxServicesPowSupplyIndex'
          item_prototypes:
            -
              uuid: aa5a704044b44909b2a348184ec71bc0
              name: '#{#SNMPVALUE}: Power supply status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.4526.10.43.1.7.1.3.{#SNMPINDEX}'
              key: 'sensor.psu.status[boxServicesPowSupplyItemState.{#SNMPINDEX}]'
              delay: 3m
              history: 2w
              trends: 0d
              description: |
                MIB: FASTPATH-BOXSERVICES-PRIVATE-MIB
                The status of power supply
              valuemap:
                name: 'FASTPATH-BOXSERVICES-PRIVATE-MIB::boxServicesPowSupplyItemState'
              tags:
                -
                  tag: Application
                  value: 'Power supply'
              trigger_prototypes:
                -
                  uuid: 76d9dba1d2f04017b22fd4b6554242e5
                  expression: '{count(#1,{$PSU_CRIT_STATUS:"failed"},eq)}=1'
                  name: '#{#SNMPVALUE}: Power supply is in critical state'
                  opdata: 'Current state: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
                  description: 'Please check the power supply unit for errors'
        -
          uuid: c63b577cb8544b54a40a4d86bc926ada
          name: 'Temperature Discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#SNMPVALUE},1.3.6.1.4.1.4526.10.43.1.8.1.1]'
          key: temp.discovery
          delay: 1h
          description: 'FASTPATH-BOXSERVICES-PRIVATE-MIB::boxServicesTempSensorsTable'
          item_prototypes:
            -
              uuid: ac4a292ab2e548fea3326aaa92162140
              name: '#{#SNMPVALUE}: Temperature status'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.4526.10.43.1.8.1.3.{#SNMPINDEX}'
              key: 'sensor.temp.status[boxServicesTempSensorState.{#SNMPINDEX}]'
              delay: 3m
              history: 2w
              trends: 0d
              description: |
                MIB: FASTPATH-BOXSERVICES-PRIVATE-MIB
                The state of temperature sensor
              valuemap:
                name: 'FASTPATH-BOXSERVICES-PRIVATE-MIB::boxServicesTempSensorState'
              tags:
                -
                  tag: Application
                  value: Temperature
            -
              uuid: 488762ecfb1549d294886681a6ec34f6
              name: '#{#SNMPVALUE}: Temperature'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.4.1.4526.10.43.1.8.1.5.{#SNMPINDEX}'
              key: 'sensor.temp.value[boxServicesTempSensorTemperature.{#SNMPINDEX}]'
              delay: 3m
              value_type: FLOAT
              units: °C
              description: |
                MIB: FASTPATH-BOXSERVICES-PRIVATE-MIB
                The temperature value reported by sensor
              tags:
                -
                  tag: Application
                  value: Temperature
              trigger_prototypes:
                -
                  uuid: ca81ff3fb0104f76b4c9248471e53903
                  expression: '{avg(5m)}<{$TEMP_CRIT_LOW:""}'
                  recovery_mode: RECOVERY_EXPRESSION
                  recovery_expression: '{min(5m)}>{$TEMP_CRIT_LOW:""}+3'
                  name: '#{#SNMPVALUE}: Temperature is too low: <{$TEMP_CRIT_LOW:""}'
                  opdata: 'Current value: {ITEM.LASTVALUE1}'
                  priority: AVERAGE
          trigger_prototypes:
            -
              uuid: 2b279cb51a8647e98b6aa6566ac143a1
              expression: |
                {Netgear Fastpath SNMP:sensor.temp.value[boxServicesTempSensorTemperature.{#SNMPINDEX}].avg(5m)}>{$TEMP_CRIT:""}
                or
                {Netgear Fastpath SNMP:sensor.temp.status[boxServicesTempSensorState.{#SNMPINDEX}].last()}={$TEMP_CRIT_STATUS}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: '{Netgear Fastpath SNMP:sensor.temp.value[boxServicesTempSensorTemperature.{#SNMPINDEX}].max(5m)}<{$TEMP_CRIT:""}-3'
              name: '#{#SNMPVALUE}: Temperature is above critical threshold: >{$TEMP_CRIT:""}'
              opdata: 'Current value: {ITEM.LASTVALUE1}'
              priority: HIGH
              description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
            -
              uuid: c518b21ca8cf4544ba166e9a82a28b75
              expression: |
                {Netgear Fastpath SNMP:sensor.temp.value[boxServicesTempSensorTemperature.{#SNMPINDEX}].avg(5m)}>{$TEMP_WARN:""}
                or
                {Netgear Fastpath SNMP:sensor.temp.status[boxServicesTempSensorState.{#SNMPINDEX}].last()}={$TEMP_WARN_STATUS}
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: '{Netgear Fastpath SNMP:sensor.temp.value[boxServicesTempSensorTemperature.{#SNMPINDEX}].max(5m)}<{$TEMP_WARN:""}-3'
              name: '#{#SNMPVALUE}: Temperature is above warning threshold: >{$TEMP_WARN:""}'
              opdata: 'Current value: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'This trigger uses temperature sensor values as well as temperature sensor status if available'
              dependencies:
                -
                  name: '#{#SNMPVALUE}: Temperature is above critical threshold: >{$TEMP_CRIT:""}'
                  expression: |
                    {Netgear Fastpath SNMP:sensor.temp.value[boxServicesTempSensorTemperature.{#SNMPINDEX}].avg(5m)}>{$TEMP_CRIT:""}
                    or
                    {Netgear Fastpath SNMP:sensor.temp.status[boxServicesTempSensorState.{#SNMPINDEX}].last()}={$TEMP_CRIT_STATUS}
                  recovery_expression: '{Netgear Fastpath SNMP:sensor.temp.value[boxServicesTempSensorTemperature.{#SNMPINDEX}].max(5m)}<{$TEMP_CRIT:""}-3'
      macros:
        -
          macro: '{$CPU.UTIL.CRIT}'
          value: '90'
        -
          macro: '{$FAN_CRIT_STATUS:"failed"}'
          value: '2'
        -
          macro: '{$MEMORY.UTIL.MAX}'
          value: '90'
        -
          macro: '{$PSU_CRIT_STATUS:"failed"}'
          value: '2'
        -
          macro: '{$TEMP_CRIT}'
          value: '60'
        -
          macro: '{$TEMP_CRIT_LOW}'
          value: '5'
        -
          macro: '{$TEMP_CRIT_STATUS}'
          value: '3'
        -
          macro: '{$TEMP_WARN}'
          value: '50'
        -
          macro: '{$TEMP_WARN_STATUS}'
          value: '2'
      valuemaps:
        -
          uuid: 3046d246b1064c749c1c9144442c0fac
          name: 'FASTPATH-BOXSERVICES-PRIVATE-MIB::boxServicesFanItemState'
          mappings:
            -
              value: '1'
              newvalue: operational
            -
              value: '2'
              newvalue: failed
            -
              value: '3'
              newvalue: powering
            -
              value: '4'
              newvalue: notpowering
            -
              value: '5'
              newvalue: notpresent
        -
          uuid: d11e2b2f01c641728d1b7f764fa49f37
          name: 'FASTPATH-BOXSERVICES-PRIVATE-MIB::boxServicesPowSupplyItemState'
          mappings:
            -
              value: '1'
              newvalue: operational
            -
              value: '2'
              newvalue: failed
            -
              value: '3'
              newvalue: powering
            -
              value: '4'
              newvalue: notpowering
            -
              value: '5'
              newvalue: notpresent
        -
          uuid: 4da55a4de7284012890e1fd5458f039a
          name: 'FASTPATH-BOXSERVICES-PRIVATE-MIB::boxServicesTempSensorState'
          mappings:
            -
              value: '1'
              newvalue: normal
            -
              value: '2'
              newvalue: warning
            -
              value: '3'
              newvalue: critical
            -
              value: '4'
              newvalue: shutdown
            -
              value: '5'
              newvalue: notpresent
            -
              value: '6'
              newvalue: notoperational
  graphs:
    -
      uuid: bcd1db5068794edd9a3d74f32bd018ed
      name: 'CPU utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        -
          drawtype: GRADIENT_LINE
          color: 1A7C11
          item:
            host: 'Netgear Fastpath SNMP'
            key: 'system.cpu.util[agentSwitchCpuProcessTotalUtilization.0]'
    -
      uuid: 1cb7d7036dfe4999b0489cc8bfa254aa
      name: 'Memory usage'
      ymin_type_1: FIXED
      graph_items:
        -
          drawtype: BOLD_LINE
          color: 1A7C11
          item:
            host: 'Netgear Fastpath SNMP'
            key: 'vm.memory.total[agentSwitchCpuProcessMemAvailable.0]'
        -
          sortorder: '1'
          drawtype: GRADIENT_LINE
          color: 2774A4
          item:
            host: 'Netgear Fastpath SNMP'
            key: 'vm.memory.available[agentSwitchCpuProcessMemFree.0]'
    -
      uuid: 88124449b8984ee6bca46269d1d3f1ae
      name: 'Memory utilization'
      ymin_type_1: FIXED
      ymax_type_1: FIXED
      graph_items:
        -
          drawtype: GRADIENT_LINE
          color: 1A7C11
          item:
            host: 'Netgear Fastpath SNMP'
            key: 'vm.memory.util[memoryUsedPercentage.0]'
