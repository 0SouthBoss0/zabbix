<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
   <version>5.0</version>
   <date>2020-05-19T03:29:40Z</date>
   <groups>
      <group>
         <name>Templates/Applications</name>
      </group>
   </groups>
   <templates>
      <template>
         <template>Template App IIS by Zabbix agent</template>
         <name>Template App IIS by Zabbix agent</name>
         <description>Get metrics from IIS using Zabbix agent running on Windows&#13;
&#13;
&#13;
You can discuss this template or leave feedback on our forum none&#13;
&#13;
Template tooling version used: 0.35</description>
         <groups>
            <group>
               <name>Templates/Applications</name>
            </group>
         </groups>
         <applications>
            <application>
               <name>IIS</name>
            </application>
         </applications>
         <items>
            <item>
               <name>IIS: {$IIS.HTTP.PORT} port ping</name>
               <type>SIMPLE</type>
               <key>net.tcp.service[http,,"{$IIS.HTTP.PORT}"]</key>
               <history>7d</history>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <valuemap>
                  <name>Service state</name>
               </valuemap>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
               <triggers>
                  <trigger>
                     <expression>{last()}=0</expression>
                     <name>IIS: Port {$IIS.HTTP.PORT} is down</name>
                     <priority>AVERAGE</priority>
                     <manual_close>YES</manual_close>
                     <dependencies>
                        <dependency>
                           <name>IIS: The World Wide Web Publishing Service (W3SVC) is not running</name>
                           <expression>{Template App IIS by Zabbix agent:service_state[W3SVC].last()}&lt;&gt;0</expression>
                        </dependency>
                     </dependencies>
                  </trigger>
               </triggers>
            </item>
            <item>
               <name>IIS: {$IIS.HTTPS.PORT} port ping</name>
               <type>SIMPLE</type>
               <key>net.tcp.service[https,,"{$IIS.HTTPS.PORT}"]</key>
               <history>7d</history>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <valuemap>
                  <name>Service state</name>
               </valuemap>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
               <triggers>
                  <trigger>
                     <expression>{last()}=0</expression>
                     <name>IIS: Port {$IIS.HTTPS.PORT} is down</name>
                     <priority>AVERAGE</priority>
                     <manual_close>YES</manual_close>
                     <dependencies>
                        <dependency>
                           <name>IIS: The World Wide Web Publishing Service (W3SVC) is not running</name>
                           <expression>{Template App IIS by Zabbix agent:service_state[W3SVC].last()}&lt;&gt;0</expression>
                        </dependency>
                     </dependencies>
                  </trigger>
               </triggers>
            </item>
            <item>
               <name>IIS: Anonymous users per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Anonymous Users/sec", 60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The number of requests from users over an anonymous connection per second. Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
            </item>
            <item>
               <name>IIS: Bytes Received per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Bytes Received/sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <units>Bps</units>
               <description>The average rate per minute at which data bytes are received by the service at the Application Layer. Does not include protocol headers or control bytes.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
            </item>
            <item>
               <name>IIS: Bytes Sent per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Bytes Sent/sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <units>Bps</units>
               <description>The average rate per minute at which data bytes are sent by the service.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
            </item>
            <item>
               <name>IIS: Bytes Total per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Bytes Total/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <units>Bps</units>
               <description>The average rate per minute of total bytes/sec transferred by the Web service (sum of bytes sent/sec and bytes received/sec)</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
            </item>
            <item>
               <name>IIS: CGI requests per second</name>
               <key>perf_counter_en["\Web Service(_Total)\CGI Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate of CGI requests that are simultaneously being processed by the Web service. Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: Connection attempts per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Connection Attempts/Sec", 60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The average rate per minute that connections using the Web service are being attempted. The count is the average for all Web sites combined.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: COPY requests per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Copy Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate HTTP requests are made using the COPY method. Copy requests are used for copying files and directories. Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: Current connections</name>
               <key>perf_counter_en["\Web Service(_Total)\Current Connections"]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The number of active connections</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
            </item>
            <item>
               <name>IIS: DELETE requests per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Delete Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate HTTP requests using the DELETE method are made. Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: GET requests total</name>
               <key>perf_counter_en["\Web Service(_Total)\Get Requests/Sec", 60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate of HTTP requests using the GET method. GET requests are generally used for basic file retrievals or image maps, though they can be used with forms. Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: HEAD requests per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Head Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate HTTP requests using the HEAD method are made. HEAD requests generally indicate a client is querying the state of a document they already have to see if it needs to be refreshed. Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: ISAPI requests per second (1m, avg)</name>
               <key>perf_counter_en["\Web Service(_Total)\ISAPI Extension Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate of ISAPI Extension requests that are simultaneously being processed by the Web service.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: Locked errors per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Locked Errors/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate of errors due to requests that couldn't be satisfied by the server because the requested document was locked. These are generally reported as an HTTP 423 error code to the client. Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: LOCK requests per second (1m, avg)</name>
               <key>perf_counter_en["\Web Service(_Total)\Lock Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate that HTTP requests are made using the LOCK method. Lock requests are used to lock a file for one user so that only that user can modify the file.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: MKCOL requests per second (1m, avg)</name>
               <key>perf_counter_en["\Web Service(_Total)\Mkcol Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate HTTP requests using the MKCOL method are made. Mkcol requests are used to create directories on the server.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: MOVE requests per second (1m, avg)</name>
               <key>perf_counter_en["\Web Service(_Total)\Move Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate HTTP requests using the MOVE method are made. Move requests are used for moving files and directories.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: NonAnonymous users per second</name>
               <key>perf_counter_en["\Web Service(_Total)\NonAnonymous Users/sec", 60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The number of requests from users over a non-anonymous connection per second. Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
            </item>
            <item>
               <name>IIS: Not Found errors per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Not Found Errors/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate of errors due to requests that couldn't be satisfied by the server because the requested document could not be found. These are generally reported to the client with HTTP error code 404. Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: OPTIONS requests per second (1m, avg)</name>
               <key>perf_counter_en["\Web Service(_Total)\Options Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate HTTP requests using the OPTIONS method are made.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: Total Other Method requests per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Other Request Methods/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>Total Other Request Methods is the number of HTTP requests that are not OPTIONS, GET, HEAD, POST, PUT, DELETE, TRACE, MOVE, COPY, MKCOL, PROPFIND, PROPPATCH, SEARCH, LOCK or UNLOCK methods (since service startup). Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: POST requests per second (1m, avg)</name>
               <key>perf_counter_en["\Web Service(_Total)\Post Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>Rate of HTTP requests using POST method. Generally used for forms or gateway requests.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: PROPFIND requests per second (1m, avg)</name>
               <key>perf_counter_en["\Web Service(_Total)\Propfind Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate HTTP requests using the PROPFIND method are made. Propfind requests retrieve property values on files and directories.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: PROPPATCH requests per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Proppatch Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate HTTP requests using the PROPPATCH method are made. Proppatch requests set property values on files and directories. Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: PUT requests per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Put Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate HTTP requests using the PUT method are made. Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: MS-SEARCH requests per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Search Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate HTTP requests using the MS-SEARCH method are made. Search requests are used to query the server to find resources that match a set of conditions provided by the client. Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: Uptime</name>
               <key>perf_counter_en["\Web Service(_Total)\Service Uptime"]</key>
               <delay>5m</delay>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <units>s</units>
               <description>Service uptime in seconds</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <triggers>
                  <trigger>
                     <expression>{last()}&lt;10m</expression>
                     <name>IIS: has been restarted (uptime &lt; 10m)</name>
                     <priority>INFO</priority>
                     <description>Uptime is less than 10 minutes</description>
                     <manual_close>YES</manual_close>
                  </trigger>
               </triggers>
            </item>
            <item>
               <name>IIS: Total connection attempts</name>
               <key>perf_counter_en["\Web Service(_Total)\Total Connection Attempts (all instances)"]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The total number of connections to the Web or FTP service that have been attempted since service startup. The count is the total for all Web sites or FTP sites combined.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: Total Method requests per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Total Method Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate of all HTTP requests are received. Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: TRACE requests per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Trace Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate of HTTP requests using the TRACE method are made. Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: TRACE requests per second</name>
               <key>perf_counter_en["\Web Service(_Total)\Unlock Requests/Sec",60]</key>
               <history>7d</history>
               <trends>30d</trends>
               <value_type>FLOAT</value_type>
               <description>The rate HTTP requests using the UNLOCK method are made. Unlock requests are used to remove locks from files. Average per minute.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
            </item>
            <item>
               <name>IIS: World Wide Web Publishing Service (W3SVC) state</name>
               <key>service_state[W3SVC]</key>
               <history>7d</history>
               <trends>30d</trends>
               <description>The World Wide Web Publishing Service (W3SVC) provides web connectivity and administration of websites through the IIS snap-in. If the World Wide Web Publishing Service stops, the operating system cannot serve any form of web request. This service was dependent on "Windows Process Activation Service".</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <valuemap>
                  <name>Windows service state</name>
               </valuemap>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
               <triggers>
                  <trigger>
                     <expression>{last()}&lt;&gt;0</expression>
                     <name>IIS: The World Wide Web Publishing Service (W3SVC) is not running</name>
                     <priority>HIGH</priority>
                     <description>The World Wide Web Publishing Service (W3SVC) is not in running state. IIS cannot start.</description>
                     <dependencies>
                        <dependency>
                           <name>IIS: Windows process Activation Service (WAS) is not running</name>
                           <expression>{Template App IIS by Zabbix agent:service_state[WAS].last()}&lt;&gt;0</expression>
                        </dependency>
                     </dependencies>
                  </trigger>
               </triggers>
            </item>
            <item>
               <name>IIS: Windows process Activation Service (WAS) state</name>
               <key>service_state[WAS]</key>
               <history>7d</history>
               <trends>30d</trends>
               <description>Windows Process Activation Service (WAS) is a tool for managing worker processes that contain applications that host Windows Communication Foundation (WCF) services. Worker processes handle requests that are sent to a Web Server for specific application pools. Each application pool sets boundaries for the applications it contains.</description>
               <applications>
                  <application>
                     <name>IIS</name>
                  </application>
               </applications>
               <valuemap>
                  <name>Windows service state</name>
               </valuemap>
               <preprocessing>
                  <step>
                     <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                     <params>10m</params>
                  </step>
               </preprocessing>
               <triggers>
                  <trigger>
                     <expression>{last()}&lt;&gt;0</expression>
                     <name>IIS: Windows process Activation Service (WAS) is not running</name>
                     <priority>HIGH</priority>
                     <description>Windows process Activation Service (WAS) is not in running state. IIS cannot start.</description>
                  </trigger>
               </triggers>
            </item>
         </items>
         <discovery_rules>
            <discovery_rule>
               <name>Application pools discovery</name>
               <type>ZABBIX_PASSIVE</type>
               <key>wmi.getall[root\webAdministration, select Name from ApplicationPool]</key>
               <delay>1h</delay>
               <item_prototypes>
                  <item_prototype>
                     <name>IIS: AppPool {#APPPOOL} state</name>
                     <key>perf_counter_en["\APP_POOL_WAS({#APPPOOL})\Current Application Pool State"]</key>
                     <history>7d</history>
                     <trends>30d</trends>
                     <description>The state of application pool</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>{#APPPOOL}</name>
                        </application_prototype>
                     </application_prototypes>
                     <valuemap>
                        <name>Application pool state</name>
                     </valuemap>
                     <preprocessing>
                        <step>
                           <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                           <params>10m</params>
                        </step>
                     </preprocessing>
                     <trigger_prototypes>
                        <trigger_prototype>
                           <expression>{last()}&lt;&gt;3 and {$IIS.APPPOOL.MONITORED:"{#APPPOOL}"}=1</expression>
                           <name>IIS: Application pool {#APPPOOL} is not in Running state</name>
                           <priority>HIGH</priority>
                        </trigger_prototype>
                     </trigger_prototypes>
                  </item_prototype>
                  <item_prototype>
                     <name>IIS: {#APPPOOL} Uptime</name>
                     <key>perf_counter_en["\APP_POOL_WAS({#APPPOOL})\Current Application Pool Uptime"]</key>
                     <delay>5m</delay>
                     <history>7d</history>
                     <trends>30d</trends>
                     <value_type>FLOAT</value_type>
                     <units>s</units>
                     <description>The web application uptime period since the last restart</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>{#APPPOOL}</name>
                        </application_prototype>
                     </application_prototypes>
                     <trigger_prototypes>
                        <trigger_prototype>
                           <expression>{last()}&lt;10m</expression>
                           <name>IIS: {#APPPOOL} has been restarted (uptime &lt; 10m)</name>
                           <priority>INFO</priority>
                           <description>Uptime is less than 10 minutes</description>
                           <manual_close>YES</manual_close>
                        </trigger_prototype>
                     </trigger_prototypes>
                  </item_prototype>
                  <item_prototype>
                     <name>IIS: AppPool {#APPPOOL} recycles</name>
                     <key>perf_counter_en["\APP_POOL_WAS({#APPPOOL})\Total Application Pool Recycles"]</key>
                     <delay>5m</delay>
                     <history>7d</history>
                     <trends>30d</trends>
                     <description>The number of times that the application pool has been recycled since Windows Process Activation Service (WAS) started.</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>{#APPPOOL}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                           <params>10m</params>
                        </step>
                     </preprocessing>
                     <trigger_prototypes>
                        <trigger_prototype>
                           <expression>{diff()}=1 and {$IIS.APPPOOL.MONITORED:"{#APPPOOL}"}=1</expression>
                           <name>IIS: Application pool {#APPPOOL} was recycled</name>
                           <priority>INFO</priority>
                        </trigger_prototype>
                     </trigger_prototypes>
                  </item_prototype>
                  <item_prototype>
                     <name>IIS: AppPool {#APPPOOL} current queue size</name>
                     <key>perf_counter_en["\HTTP Service Request Queues({#APPPOOL})\CurrentQueueSize"]</key>
                     <delay>5m</delay>
                     <history>7d</history>
                     <trends>30d</trends>
                     <description>The number of requests in the queue</description>
                     <application_prototypes>
                        <application_prototype>
                           <name>{#APPPOOL}</name>
                        </application_prototype>
                     </application_prototypes>
                     <preprocessing>
                        <step>
                           <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                           <params>10m</params>
                        </step>
                     </preprocessing>
                     <trigger_prototypes>
                        <trigger_prototype>
                           <expression>{last()}&gt;{$IIS.QUEUE.MAX.WARN}</expression>
                           <name>IIS: Request queue of {#APPPOOL} is too large (over {$IIS.QUEUE.MAX.WARN})</name>
                           <priority>WARNING</priority>
                           <dependencies>
                              <dependency>
                                 <name>IIS: Application pool {#APPPOOL} is not in Running state</name>
                                 <expression>{Template App IIS by Zabbix agent:perf_counter_en["\APP_POOL_WAS({#APPPOOL})\Current Application Pool State"].last()}&lt;&gt;3 and {$IIS.APPPOOL.MONITORED:"{#APPPOOL}"}=1</expression>
                              </dependency>
                           </dependencies>
                        </trigger_prototype>
                     </trigger_prototypes>
                  </item_prototype>
               </item_prototypes>
               <lld_macro_paths>
                  <lld_macro_path>
                     <lld_macro>{#APPPOOL}</lld_macro>
                     <path>$.Name</path>
                  </lld_macro_path>
               </lld_macro_paths>
            </discovery_rule>
         </discovery_rules>
         <macros>
            <macro>
               <macro>{$IIS.APPPOOL.MONITORED}</macro>
               <value>1</value>
               <description>Monitorng status for discovered Application pools. Use context to avoid trigger firing for specific application pools. "1" - enabled, "0" - disbled.</description>
            </macro>
            <macro>
               <macro>{$IIS.HTTP.PORT}</macro>
               <value>80</value>
               <description>Listened port for HTTP.</description>
            </macro>
            <macro>
               <macro>{$IIS.HTTPS.PORT}</macro>
               <value>443</value>
               <description>Listened port for HTTPS.</description>
            </macro>
            <macro>
               <macro>{$IIS.QUEUE.MAX.WARN}</macro>
               <description>Maximum application pool's request queue length for trigger expression</description>
            </macro>
         </macros>
      </template>
   </templates>
   <graphs>
      <graph>
         <name>IIS: Requests rate</name>
         <graph_items>
            <graph_item>
               <color>1A7C11</color>
               <item>
                  <host>Template App IIS by Zabbix agent</host>
                  <key>perf_counter_en["\Web Service(_Total)\Total Method Requests/Sec",60]</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>1</sortorder>
               <color>2774A4</color>
               <item>
                  <host>Template App IIS by Zabbix agent</host>
                  <key>perf_counter_en["\Web Service(_Total)\Other Request Methods/Sec",60]</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>2</sortorder>
               <color>F63100</color>
               <item>
                  <host>Template App IIS by Zabbix agent</host>
                  <key>perf_counter_en["\Web Service(_Total)\Get Requests/Sec", 60]</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>3</sortorder>
               <color>A54F10</color>
               <item>
                  <host>Template App IIS by Zabbix agent</host>
                  <key>perf_counter_en["\Web Service(_Total)\Post Requests/Sec",60]</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>4</sortorder>
               <color>FC6EA3</color>
               <item>
                  <host>Template App IIS by Zabbix agent</host>
                  <key>perf_counter_en["\Web Service(_Total)\Put Requests/Sec",60]</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>5</sortorder>
               <color>6C59DC</color>
               <item>
                  <host>Template App IIS by Zabbix agent</host>
                  <key>perf_counter_en["\Web Service(_Total)\Delete Requests/Sec",60]</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>6</sortorder>
               <color>AC8C14</color>
               <item>
                  <host>Template App IIS by Zabbix agent</host>
                  <key>perf_counter_en["\Web Service(_Total)\Head Requests/Sec",60]</key>
               </item>
            </graph_item>
            <graph_item>
               <sortorder>7</sortorder>
               <color>611F27</color>
               <item>
                  <host>Template App IIS by Zabbix agent</host>
                  <key>perf_counter_en["\Web Service(_Total)\Trace Requests/Sec",60]</key>
               </item>
            </graph_item>
         </graph_items>
      </graph>
   </graphs>
   <value_maps>
      <value_map>
         <name>Service state</name>
         <mappings>
            <mapping>
               <value>0</value>
               <newvalue>Down</newvalue>
            </mapping>
            <mapping>
               <value>1</value>
               <newvalue>Up</newvalue>
            </mapping>
         </mappings>
      </value_map>
      <value_map>
         <name>Windows service state</name>
         <mappings>
            <mapping>
               <value>0</value>
               <newvalue>Running</newvalue>
            </mapping>
            <mapping>
               <value>1</value>
               <newvalue>Paused</newvalue>
            </mapping>
            <mapping>
               <value>2</value>
               <newvalue>Start pending</newvalue>
            </mapping>
            <mapping>
               <value>3</value>
               <newvalue>Pause pending</newvalue>
            </mapping>
            <mapping>
               <value>4</value>
               <newvalue>Continue pending</newvalue>
            </mapping>
            <mapping>
               <value>5</value>
               <newvalue>Stop pending</newvalue>
            </mapping>
            <mapping>
               <value>6</value>
               <newvalue>Stopped</newvalue>
            </mapping>
            <mapping>
               <value>7</value>
               <newvalue>Unknown</newvalue>
            </mapping>
            <mapping>
               <value>255</value>
               <newvalue>No such service</newvalue>
            </mapping>
         </mappings>
      </value_map>
      <value_map>
         <name>Application pool state</name>
         <mappings>
            <mapping>
               <value>1</value>
               <newvalue>Uninitialized</newvalue>
            </mapping>
            <mapping>
               <value>2</value>
               <newvalue>Initialized</newvalue>
            </mapping>
            <mapping>
               <value>3</value>
               <newvalue>Running</newvalue>
            </mapping>
            <mapping>
               <value>4</value>
               <newvalue>Disabling</newvalue>
            </mapping>
            <mapping>
               <value>5</value>
               <newvalue>Disabled</newvalue>
            </mapping>
            <mapping>
               <value>6</value>
               <newvalue>Shutdown Pending</newvalue>
            </mapping>
            <mapping>
               <value>7</value>
               <newvalue>Delete Pending</newvalue>
            </mapping>
         </mappings>
      </value_map>
   </value_maps>
</zabbix_export>
